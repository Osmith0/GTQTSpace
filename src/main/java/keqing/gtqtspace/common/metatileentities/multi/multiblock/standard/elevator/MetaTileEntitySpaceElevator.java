package keqing.gtqtspace.common.metatileentities.multi.multiblock.standard.elevator;

import codechicken.lib.render.CCRenderState;
import codechicken.lib.render.pipeline.IVertexOperation;
import codechicken.lib.vec.Matrix4;
import gregtech.api.capability.IEnergyContainer;
import gregtech.api.capability.IOpticalComputationHatch;
import gregtech.api.capability.IOpticalComputationProvider;
import gregtech.api.capability.impl.EnergyContainerList;
import gregtech.api.gui.GuiTextures;
import gregtech.api.gui.ModularUI;
import gregtech.api.gui.widgets.AdvancedTextWidget;
import gregtech.api.gui.widgets.ClickButtonWidget;
import gregtech.api.gui.widgets.ImageCycleButtonWidget;
import gregtech.api.gui.widgets.ImageWidget;
import gregtech.api.metatileentity.IFastRenderMetaTileEntity;
import gregtech.api.metatileentity.MetaTileEntity;
import gregtech.api.metatileentity.interfaces.IGregTechTileEntity;
import gregtech.api.metatileentity.multiblock.IMultiblockPart;
import gregtech.api.metatileentity.multiblock.MultiblockAbility;
import gregtech.api.metatileentity.multiblock.MultiblockDisplayText;
import gregtech.api.metatileentity.multiblock.MultiblockWithDisplayBase;
import gregtech.api.pattern.BlockPattern;
import gregtech.api.pattern.FactoryBlockPattern;
import gregtech.api.pattern.PatternMatchContext;
import gregtech.api.pattern.TraceabilityPredicate;
import gregtech.api.util.TextComponentUtil;
import gregtech.client.renderer.ICubeRenderer;
import gregtech.client.renderer.texture.Textures;
import keqing.gtqtcore.api.blocks.impl.WrappedIntTired;
import keqing.gtqtspace.api.multiblock.ISpaceElevatorProvider;
import keqing.gtqtspace.api.multiblock.ISpaceElevatorReceiver;
import keqing.gtqtspace.api.predicate.TiredTraceabilityPredicate;
import keqing.gtqtspace.api.utils.GTQTSUtil;
import keqing.gtqtspace.client.objmodels.ObjModels;
import keqing.gtqtspace.client.textures.GTQTSTextures;
import keqing.gtqtspace.common.block.GTQTSMetaBlocks;
import keqing.gtqtspace.common.block.blocks.GTQTSpaceElevatorCasing;
import keqing.gtqtspace.world.Teleporter.WorldTeleporter;
import net.minecraft.block.Block;
import net.minecraft.block.state.IBlockState;
import net.minecraft.client.renderer.GlStateManager;
import net.minecraft.client.resources.I18n;
import net.minecraft.entity.player.EntityPlayer;
import net.minecraft.entity.player.EntityPlayerMP;
import net.minecraft.item.ItemStack;
import net.minecraft.nbt.NBTTagCompound;
import net.minecraft.network.PacketBuffer;
import net.minecraft.tileentity.TileEntity;
import net.minecraft.util.ResourceLocation;
import net.minecraft.util.math.AxisAlignedBB;
import net.minecraft.util.text.ITextComponent;
import net.minecraft.util.text.TextFormatting;
import net.minecraft.world.World;
import net.minecraftforge.fml.client.FMLClientHandler;
import net.minecraftforge.fml.common.FMLCommonHandler;
import net.minecraftforge.fml.relauncher.Side;
import net.minecraftforge.fml.relauncher.SideOnly;

import javax.annotation.Nonnull;
import java.util.ArrayList;
import java.util.Collection;
import java.util.Collections;
import java.util.List;
import java.util.concurrent.ConcurrentHashMap;

import static gregtech.api.unification.material.Materials.Naquadah;
import static gregtech.api.util.RelativeDirection.*;

public class MetaTileEntitySpaceElevator extends MultiblockWithDisplayBase implements ISpaceElevatorProvider, IFastRenderMetaTileEntity {
    private final Collection<ISpaceElevatorReceiver> spaceElevatorReceivers = ConcurrentHashMap.newKeySet();
    protected IOpticalComputationProvider computationProvider;
    protected IEnergyContainer energyContainer;
    protected int motorTier = 0;
    private boolean isExtended = false;

    public MetaTileEntitySpaceElevator(ResourceLocation metaTileEntityId) {
        super(metaTileEntityId);
    }

    @Override
    public boolean amIInTheList(ISpaceElevatorReceiver receiver) {
        return this.spaceElevatorReceivers.contains(receiver);
    }

    @Override
    public MetaTileEntity createMetaTileEntity(IGregTechTileEntity iGregTechTileEntity) {
        return new MetaTileEntitySpaceElevator(metaTileEntityId);
    }

    @Override
    public void update() {
        super.update();
        if (!isStructureFormed())
            this.spaceElevatorReceivers.forEach(ISpaceElevatorReceiver::sentWorkingDisabled);
    }

    @Override
    protected void updateFormedValid() {
        if (!this.spaceElevatorReceivers.isEmpty()) {
            if (!checkModules()) {
                invalidateStructure();
            }
        }
        if (this.getOffsetTimer() % 20 == 0) {
            this.spaceElevatorReceivers.forEach(s -> {
                if (s.getSpaceElevator() == null)
                    this.spaceElevatorReceivers.remove(s);
            });
        }
    }

    @Override
    protected BlockPattern createStructurePattern() {
        if (!this.isExtended) {
            return FactoryBlockPattern.start(RIGHT, DOWN, FRONT)
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "               FF FF               ", "               AAAAA               ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "               D   D               ", "            FFFFF FFFFF            ", "            AAAAAAAAAAA            ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "            DDDDE EDDDD            ", "          FFFFFFF FFFFFFF          ", "          AAAAAAAAAAAAAAA          ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                E E                ", "          DD   DE ED   DD          ", "         FFFFFFD   DFFFFFF         ", "        AAAAAAAAAAAAAAAAAAA        ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                E E                ", "               DE ED               ", "               D   D               ", "         FFF           FFF         ", "       AAAAAAAAAAAAAAAAAAAAA       ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                E E                ", "               DE ED               ", "               DE ED               ", "                                   ", "                                   ", "      AAAAAAAAAAAAAAAAAAAAAAA      ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                E E                ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "                                   ", "                                   ", "                                   ", "     AAAAAAAAAAAAAAAAAAAAAAAAA     ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                E E                ", "              HDE EDH              ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "    AAAAAAAAAAAAAAAAAAAAAAAAAAA    ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                E E                ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "            HH DE ED HH            ", "                                   ", "                                   ", "                                   ", "                                   ", "               V V V               ", "               V V V               ", "               V V V               ", "               V V V               ", "   AAAAAAAAAAAAV V VAAAAAAAAAAAA   ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                E E                ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "                                   ", "         E               E         ", "         EHH           HHE         ", "         E               E         ", "         E               E         ", "         E               E         ", "         E               E         ", "         E     V V V     E         ", "         E     I I I     E         ", "         E     V V V     E         ", "   FF    E     V V V     E    FF   ", "   AAAAAAAAAAAAV V VAAAAAAAAAAAA   ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                E E                ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "          E             E          ", "          E             E          ", "          E             E          ", "          E             E          ", "          E             E          ", "         HE             EH         ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "   D                           D   ", "  FFF          F F F          FFF  ", "  AAAAAAAAAAAAA     AAAAAAAAAAAAA  ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                E E                ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "                                   ", "                                   ", "           E           E           ", "           E           E           ", "           E           E           ", "           E           E           ", "           E           E           ", "                                   ", "                                   ", "         H               H         ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "   D                           D   ", "  FFF          F F F          FFF  ", "  AAAAAAAAAAAAA     AAAAAAAAAAAAA  ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                E E                ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "             HH     HH             ", "            E         E            ", "            E         E            ", "            E         E            ", "            E         E            ", "            E         E            ", "            E         E            ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "        H                 H        ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "  D                             D  ", " FFF          FFFFFFF          FFF ", " AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                FFF                ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "             E       E             ", "             E       E             ", "             E       E             ", "             E       E             ", "             E       E             ", "             E       E             ", "             E       E             ", "            HE       EH            ", "             E       E             ", "             E       E             ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "        H                 H        ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "  D                             D  ", " FFF         FFFFFFFFF         FFF ", " AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA ")
                    .aisle("                FFF                ", "                 E                 ", "                 E                 ", "                 E                 ", "                 E                 ", "                 E                 ", "               F   F               ", "              E     E              ", "              E     E              ", "              E     E              ", "              E     E              ", "              E     E              ", "              E     E              ", "              E     E              ", "              E     E              ", "              E     E              ", "                                   ", "                                   ", "                FFF                ", "                                   ", "                                   ", "            H         H            ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                FFF                ", "                                   ", "                                   ", "                                   ", "                                   ", "       H                   H       ", "                                   ", "                                   ", "                                   ", "                                   ", "                XXX                ", "                X~X                ", "  D             XXX             D  ", " FFF        FFFFFFFFFFF        FFF ", " AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA ")
                    .aisle("               F D F               ", "                 D                 ", "                 D                 ", "                 D                 ", "                 D                 ", "                 D                 ", "              F  D  F              ", "                 D                 ", "            D    D    D            ", "            D    D    D            ", "            D    D    D            ", "            D    D    D            ", "            D    D    D            ", "            D    D    D            ", "            D    D    D            ", "           DD    D    DD           ", "           D     D     D           ", "           D     D     D           ", "           D   F D F   D           ", "           D     C     D           ", "           D     C     D           ", "           D     C     D           ", "           D     C     D           ", "          DD     C     DD          ", "          D      C      D          ", "          D      C      D          ", "          D      C      D          ", "         DD      C      DD         ", "         D     FDCDF     D         ", "         D      DCD      D         ", "        DD      DCD      DD        ", "        D       DCD       D        ", "        D       DCD       D        ", "       DD      DDCDD      DD       ", "       D       D C D       D       ", "       D       D C D       D       ", "      DD       D C D       DD      ", "      D        D C D        D      ", "     DD VV     XDCDX     VV DD     ", "    DD  VI     XDCDX     IV  DD    ", " DDDD   VV     XDCDX     VV   DDDD ", "FFFD    VVFFFFFDDDDDFFFFFVV    DFFF", "AAAAAAAAVV  AAAXXXXXAAA  VVAAAAAAAA")
                    .aisle("              F     F              ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "             F       F             ", "            E         E            ", "            E         E            ", "            E         E            ", "            E         E            ", "            E         E            ", "            E         E            ", "            E         E            ", "           EE         EE           ", "           EE         EE           ", "           E           E           ", "           E           E           ", "           E  F     F  E           ", "           E           E           ", "           E           E           ", "           E           E           ", "          EE           EE          ", "          EE           EE          ", "          E             E          ", "          E             E          ", "         EE             EE         ", "         EE             EE         ", "         E    FD   DF    E         ", "        EE     D   D     EE        ", "        EE     D   D     EE        ", "        E      D   D      E        ", "       EE      D   D      EE       ", "       EE      D   D      EE       ", "       E                   E       ", "      EE                   EE      ", "      EE                   EE      ", "     EE                     EE     ", "    EEE       XD   DX       EEE    ", "   EEE        XD   DX        EEE   ", "  EE          XD   DX          EE  ", "FFF         FFFDDDDDFFF         FFF", "AAAAAAAA    AAAXXXXXAAA    AAAAAAAA")
                    .aisle("              FD   DF              ", "              ED   DE              ", "              ED   DE              ", "              ED   DE              ", "              ED   DE              ", "              ED   DE              ", "             F D   D F             ", "               D   D               ", "               D   D               ", "               D   D               ", "               D   D               ", "               D   D               ", "               D   D               ", "               D   D               ", "               D   D               ", "               D   D               ", "               D   D               ", "               D B D               ", "              FD - DF              ", "               C - C               ", "               C - C               ", "               C - C               ", "               C - C               ", "               C - C               ", "               C - C               ", "               C - C               ", "               C - C               ", "               C - C               ", "              FC - CF              ", "               C - C               ", "               C - C               ", "               C - C               ", "               C - C               ", "               C - C               ", "               C - C               ", "               C - C               ", "               C - C               ", "               C - C               ", "        VV    XC - CX    VV        ", "        VI    XC - CX    IV        ", "        VV    XC - CX    VV        ", "        VVFFFFFDDDDDFFFFFVV        ", "AAAAAAAAVV  AAAXXXXXAAA  VVAAAAAAAA")
                    .aisle("              F     F              ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "             F       F             ", "            E         E            ", "            E         E            ", "            E         E            ", "            E         E            ", "            E         E            ", "            E         E            ", "            E         E            ", "           EE         EE           ", "           EE         EE           ", "           E           E           ", "           E           E           ", "           E  F     F  E           ", "           E           E           ", "           E           E           ", "           E           E           ", "          EE           EE          ", "          EE           EE          ", "          E             E          ", "          E             E          ", "         EE             EE         ", "         EE             EE         ", "         E    FD   DF    E         ", "        EE     D   D     EE        ", "        EE     D   D     EE        ", "        E      D   D      E        ", "       EE      D   D      EE       ", "       EE      D   D      EE       ", "       E                   E       ", "      EE                   EE      ", "      EE                   EE      ", "     EE                     EE     ", "    EEE       XD   DX       EEE    ", "   EEE        XD   DX        EEE   ", "  EE          XD   DX          EE  ", "FFF         FFFDDDDDFFF         FFF", "AAAAAAAA    AAAXXXXXAAA    AAAAAAAA")
                    .aisle("               F D F               ", "                 D                 ", "                 D                 ", "                 D                 ", "                 D                 ", "                 D                 ", "              F  D  F              ", "                 D                 ", "            D    D    D            ", "            D    D    D            ", "            D    D    D            ", "            D    D    D            ", "            D    D    D            ", "            D    D    D            ", "            D    D    D            ", "           DD    D    DD           ", "           D     D     D           ", "           D     D     D           ", "           D   F D F   D           ", "           D     C     D           ", "           D     C     D           ", "           D     C     D           ", "           D     C     D           ", "          DD     C     DD          ", "          D      C      D          ", "          D      C      D          ", "          D      C      D          ", "         DD      C      DD         ", "         D     FDCDF     D         ", "         D      DCD      D         ", "        DD      DCD      DD        ", "        D       DCD       D        ", "        D       DCD       D        ", "       DD      DDCDD      DD       ", "       D       D C D       D       ", "       D       D C D       D       ", "      DD       D C D       DD      ", "      D        D C D        D      ", "     DD VV     XDCDX     VV DD     ", "    DD  VI     XDCDX     IV  DD    ", " DDDD   VV     XDCDX     VV   DDDD ", "FFFD    VVFFFFFDDDDDFFFFFVV    DFFF", "AAAAAAAAVV  AAAXXXXXAAA  VVAAAAAAAA")
                    .aisle("                FFF                ", "                 E                 ", "                 E                 ", "                 E                 ", "                 E                 ", "                 E                 ", "               F   F               ", "              E     E              ", "              E     E              ", "              E     E              ", "              E     E              ", "              E     E              ", "              E     E              ", "              E     E              ", "              E     E              ", "              E     E              ", "                                   ", "                                   ", "                FFF                ", "                                   ", "                                   ", "            H         H            ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                FFF                ", "                                   ", "                                   ", "                                   ", "                                   ", "       H                   H       ", "                                   ", "                                   ", "                                   ", "                                   ", "                XXX                ", "                XXX                ", "  D             XXX             D  ", " FFF        FFFFFFFFFFF        FFF ", " AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                FFF                ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "             E       E             ", "             E       E             ", "             E       E             ", "             E       E             ", "             E       E             ", "             E       E             ", "             E       E             ", "            HE       EH            ", "             E       E             ", "             E       E             ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "        H                 H        ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "  D                             D  ", " FFF         FFFFFFFFF         FFF ", " AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                E E                ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "             HH     HH             ", "            E         E            ", "            E         E            ", "            E         E            ", "            E         E            ", "            E         E            ", "            E         E            ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "        H                 H        ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "  D                             D  ", " FFF          FFFFFFF          FFF ", " AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                E E                ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "                                   ", "                                   ", "           E           E           ", "           E           E           ", "           E           E           ", "           E           E           ", "           E           E           ", "                                   ", "                                   ", "         H               H         ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "   D                           D   ", "  FFF          F F F          FFF  ", "  AAAAAAAAAAAAA     AAAAAAAAAAAAA  ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                E E                ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "          E             E          ", "          E             E          ", "          E             E          ", "          E             E          ", "          E             E          ", "         HE             EH         ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "   D                           D   ", "  FFF          F F F          FFF  ", "  AAAAAAAAAAAAA     AAAAAAAAAAAAA  ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                E E                ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "                                   ", "         E               E         ", "         EHH           HHE         ", "         E               E         ", "         E               E         ", "         E               E         ", "         E               E         ", "         E     V V V     E         ", "         E     I I I     E         ", "         E     V V V     E         ", "   FF    E     V V V     E    FF   ", "   AAAAAAAAAAAAV V VAAAAAAAAAAAA   ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                E E                ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "            HH DE ED HH            ", "                                   ", "                                   ", "                                   ", "                                   ", "               V V V               ", "               V V V               ", "               V V V               ", "               V V V               ", "   AAAAAAAAAAAAV V VAAAAAAAAAAAA   ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                E E                ", "              HDE EDH              ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "    AAAAAAAAAAAAAAAAAAAAAAAAAAA    ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                E E                ", "               DE ED               ", "               DE ED               ", "               DE ED               ", "                                   ", "                                   ", "                                   ", "     AAAAAAAAAAAAAAAAAAAAAAAAA     ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                E E                ", "               DE ED               ", "               DE ED               ", "                                   ", "                                   ", "      AAAAAAAAAAAAAAAAAAAAAAA      ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                E E                ", "               DE ED               ", "               D   D               ", "         FFF           FFF         ", "       AAAAAAAAAAAAAAAAAAAAA       ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                E E                ", "          DD   DE ED   DD          ", "         FFFFFFD   DFFFFFF         ", "        AAAAAAAAAAAAAAAAAAA        ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "            DDDDE EDDDD            ", "          FFFFFFF FFFFFFF          ", "          AAAAAAAAAAAAAAA          ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "               D   D               ", "            FFFFF FFFFF            ", "            AAAAAAAAAAA            ")
                    .aisle("                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "                                   ", "               FF FF               ", "               AAAAA               ")
                    .where(' ', any())
                    .where('-', air())
                    .where('~', selfPredicate())
                    .where('D', states(GTQTSMetaBlocks.spaceElevatorCasing.getState(GTQTSpaceElevatorCasing.ElevatorCasingType.BASIC_CASING)))
                    .where('F', states(GTQTSMetaBlocks.spaceElevatorCasing.getState(GTQTSpaceElevatorCasing.ElevatorCasingType.INTERNAL_STRUCTURE)))
                    .where('E', states(GTQTSMetaBlocks.spaceElevatorCasing.getState(GTQTSpaceElevatorCasing.ElevatorCasingType.SUPPORT_STRUCTURE)))
                    .where('A', states(GTQTSMetaBlocks.spaceElevatorCasing.getState(GTQTSpaceElevatorCasing.ElevatorCasingType.FLOOR)))
                    .where('B', states(GTQTSMetaBlocks.spaceElevatorCasing.getState(GTQTSpaceElevatorCasing.ElevatorCasingType.CABLE_CASING)))
                    .where('H', frames(Naquadah))
                    .where('X', states(GTQTSMetaBlocks.spaceElevatorCasing.getState(GTQTSpaceElevatorCasing.ElevatorCasingType.BASIC_CASING))
                            .or(abilities(MultiblockAbility.INPUT_ENERGY, MultiblockAbility.INPUT_LASER).setExactLimit(1))
                            .or(abilities(MultiblockAbility.COMPUTATION_DATA_RECEPTION).setExactLimit(1)))
                    .where('C', TiredTraceabilityPredicate.CP_SE_CASING.get())
                    .where('I', modulePredicate())
                    .where('V', states(GTQTSMetaBlocks.spaceElevatorCasing.getState(GTQTSpaceElevatorCasing.ElevatorCasingType.BASIC_CASING))
                            .or(abilities(MultiblockAbility.IMPORT_ITEMS, MultiblockAbility.IMPORT_FLUIDS, MultiblockAbility.EXPORT_FLUIDS, MultiblockAbility.EXPORT_ITEMS).setPreviewCount(0)))
                    .build();
        } else {
            return FactoryBlockPattern.start(RIGHT, DOWN, FRONT)
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                    FFFFFFF                    ", "                    AAAAAAA                    ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                     V V V                     ", "                     V V V                     ", "                     V V V                     ", "                   FFV V VFF                   ", "                 AAAAV V VAAAA                 ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                     V V V                     ", "                     I I I                     ", "                     V V V                     ", "                   FFV V VFF                   ", "              AAAAAAAV V VAAAAAAA              ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                   FFF F FFF                   ", "            AAAAAAAAAA   AAAAAAAAAA            ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                  FFFF F FFFF                  ", "          AAAA   AAAAA   AAAAA   AAAA          ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                  FFFF F FFFF                  ", "        AAAA     AAAAA   AAAAA     AAAA        ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                  FFFFFFFFFFF                  ", "       AAA      AAAAAAAAAAAAAAA      AAA       ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                     D   D                     ", "                  FFFFF FFFFF                  ", "      AAA       AAAAAAAAAAAAAAA       AAA      ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                  DDDDE EDDDD                  ", "                FFFFFFF FFFFFFF                ", "     AAA        AAAAAAAAAAAAAAA        AAA     ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      E E                      ", "                DD   DE ED   DD                ", "               FFFFFFD   DFFFFFF               ", "     AA       AAAAAAAAAAAAAAAAAAA       AA     ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      E E                      ", "                     DE ED                     ", "                     D   D                     ", "               FFF           FFF               ", "    AA       AAAAAAAAAAAAAAAAAAAAA       AA    ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      E E                      ", "                     DE ED                     ", "                     DE ED                     ", "                                               ", "                                               ", "    AA      AAAAAAAAAAAAAAAAAAAAAAA      AA    ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      E E                      ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                                               ", "                                               ", "                                               ", "   AA      AAAAAAAAAAAAAAAAAAAAAAAAA      AA   ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      E E                      ", "                    HDE EDH                    ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "   AA     AAAAAAAAAAAAAAAAAAAAAAAAAAA     AA   ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      E E                      ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                  HH DE ED HH                  ", "                                               ", "                                               ", "                                               ", "                                               ", "                     V V V                     ", "                     V V V                     ", "                     V V V                     ", "                     V V V                     ", "  AA     AAAAAAAAAAAAV V VAAAAAAAAAAAA     AA  ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      E E                      ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                                               ", "               E               E               ", "               EHH           HHE               ", "               E               E               ", "               E               E               ", "               E               E               ", "               E               E               ", "               E     V V V     E               ", "               E     I I I     E               ", "               E     V V V     E               ", "         FF    E     V V V     E    FF         ", "  AA     AAAAAAAAAAAAV V VAAAAAAAAAAAA     AA  ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      E E                      ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                E             E                ", "                E             E                ", "                E             E                ", "                E             E                ", "                E             E                ", "               HE             EH               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "         D                           D         ", "        FFF          F F F          FFF        ", "  AA  AAAAAAAAAAAAAAA     AAAAAAAAAAAAAAA  AA  ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      E E                      ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                                               ", "                                               ", "                 E           E                 ", "                 E           E                 ", "                 E           E                 ", "                 E           E                 ", "                 E           E                 ", "                                               ", "                                               ", "               H               H               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "         D                           D         ", "        FFF          F F F          FFF        ", " AAAAAAAAAAAAAAAAAAAA     AAAAAAAAAAAAAAAAAAAA ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      E E                      ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                   HH     HH                   ", "                  E         E                  ", "                  E         E                  ", "                  E         E                  ", "                  E         E                  ", "                  E         E                  ", "                  E         E                  ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "              H                 H              ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "        D                             D        ", "    FFFFFF          FFFFFFF          FFFFFF    ", " AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      FFF                      ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                   E       E                   ", "                   E       E                   ", "                   E       E                   ", "                   E       E                   ", "                   E       E                   ", "                   E       E                   ", "                   E       E                   ", "                  HE       EH                  ", "                   E       E                   ", "                   E       E                   ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "              H                 H              ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "        D                             D        ", " FFFFFFFFF         FFFFFFFFF         FFFFFFFFF ", " AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA ")
                    .aisle("                      FFF                      ", "                       E                       ", "                       E                       ", "                       E                       ", "                       E                       ", "                       E                       ", "                     F   F                     ", "                    E     E                    ", "                    E     E                    ", "                    E     E                    ", "                    E     E                    ", "                    E     E                    ", "                    E     E                    ", "                    E     E                    ", "                    E     E                    ", "                    E     E                    ", "                                               ", "                                               ", "                      FFF                      ", "                                               ", "                                               ", "                  H         H                  ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      FFF                      ", "                                               ", "                                               ", "                                               ", "                                               ", "             H                   H             ", "                                               ", "                                               ", "                                               ", "                                               ", "                      XXX                      ", "                      X~X                      ", "        D             XXX             D        ", "FFFFFFFFFF        FFFFFFFFFFF        FFFFFFFFFF", "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA")
                    .aisle("                     F D F                     ", "                       D                       ", "                       D                       ", "                       D                       ", "                       D                       ", "                       D                       ", "                    F  D  F                    ", "                       D                       ", "                  D    D    D                  ", "                  D    D    D                  ", "                  D    D    D                  ", "                  D    D    D                  ", "                  D    D    D                  ", "                  D    D    D                  ", "                  D    D    D                  ", "                 DD    D    DD                 ", "                 D     D     D                 ", "                 D     D     D                 ", "                 D   F D F   D                 ", "                 D     C     D                 ", "                 D     C     D                 ", "                 D     C     D                 ", "                 D     C     D                 ", "                DD     C     DD                ", "                D      C      D                ", "                D      C      D                ", "                D      C      D                ", "               DD      C      DD               ", "               D     FDCDF     D               ", "               D      DCD      D               ", "              DD      DCD      DD              ", "              D       DCD       D              ", "              D       DCD       D              ", "             DD      DDCDD      DD             ", "             D       D C D       D             ", "             D       D C D       D             ", "            DD       D C D       DD            ", "            D        D C D        D            ", " VV        DD VV     XDCDX     VV DD        VV ", " VI       DD  VI     XDCDX     IV  DD       IV ", " VV    DDDD   VV     XDCDX     VV   DDDD    VV ", "FVVFFFFFFD    VVFFFFFDDDDDFFFFFVV    DFFFFFFVVF", "AVVAAAAAAAAAAAVV  AAAXXXXXAAA  VVAAAAAAAAAAAVVA")
                    .aisle("                    F     F                    ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                   F       F                   ", "                  E         E                  ", "                  E         E                  ", "                  E         E                  ", "                  E         E                  ", "                  E         E                  ", "                  E         E                  ", "                  E         E                  ", "                 EE         EE                 ", "                 EE         EE                 ", "                 E           E                 ", "                 E           E                 ", "                 E  F     F  E                 ", "                 E           E                 ", "                 E           E                 ", "                 E           E                 ", "                EE           EE                ", "                EE           EE                ", "                E             E                ", "                E             E                ", "               EE             EE               ", "               EE             EE               ", "               E    FD   DF    E               ", "              EE     D   D     EE              ", "              EE     D   D     EE              ", "              E      D   D      E              ", "             EE      D   D      EE             ", "             EE      D   D      EE             ", "             E                   E             ", "            EE                   EE            ", "            EE                   EE            ", "           EE                     EE           ", "          EEE       XD   DX       EEE          ", "         EEE        XD   DX        EEE         ", "        EE          XD   DX          EE        ", "F     FFF         FFFDDDDDFFF         FFF     F", "A     AAAAAAAA    AAAXXXXXAAA    AAAAAAAA     A")
                    .aisle("                    FD   DF                    ", "                    ED   DE                    ", "                    ED   DE                    ", "                    ED   DE                    ", "                    ED   DE                    ", "                    ED   DE                    ", "                   F D   D F                   ", "                     D   D                     ", "                     D   D                     ", "                     D   D                     ", "                     D   D                     ", "                     D   D                     ", "                     D   D                     ", "                     D   D                     ", "                     D   D                     ", "                     D   D                     ", "                     D   D                     ", "                     D B D                     ", "                    FD - DF                    ", "                     C - C                     ", "                     C - C                     ", "                     C - C                     ", "                     C - C                     ", "                     C - C                     ", "                     C - C                     ", "                     C - C                     ", "                     C - C                     ", "                     C - C                     ", "                    FC - CF                    ", "                     C - C                     ", "                     C - C                     ", "                     C - C                     ", "                     C - C                     ", "                     C - C                     ", "                     C - C                     ", "                     C - C                     ", "                     C - C                     ", "                     C - C                     ", " VV           VV    XC - CX    VV           VV ", " VI           VI    XC - CX    IV           IV ", " VV           VV    XC - CX    VV           VV ", "FVVFFFF       VVFFFFFDDDDDFFFFFVV       FFFFVVF", "AVV   AAAAAAAAVV  AAAXXXXXAAA  VVAAAAAAAA   VVA")
                    .aisle("                    F     F                    ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                   F       F                   ", "                  E         E                  ", "                  E         E                  ", "                  E         E                  ", "                  E         E                  ", "                  E         E                  ", "                  E         E                  ", "                  E         E                  ", "                 EE         EE                 ", "                 EE         EE                 ", "                 E           E                 ", "                 E           E                 ", "                 E  F     F  E                 ", "                 E           E                 ", "                 E           E                 ", "                 E           E                 ", "                EE           EE                ", "                EE           EE                ", "                E             E                ", "                E             E                ", "               EE             EE               ", "               EE             EE               ", "               E    FD   DF    E               ", "              EE     D   D     EE              ", "              EE     D   D     EE              ", "              E      D   D      E              ", "             EE      D   D      EE             ", "             EE      D   D      EE             ", "             E                   E             ", "            EE                   EE            ", "            EE                   EE            ", "           EE                     EE           ", "          EEE       XD   DX       EEE          ", "         EEE        XD   DX        EEE         ", "        EE          XD   DX          EE        ", "F     FFF         FFFDDDDDFFF         FFF     F", "A     AAAAAAAA    AAAXXXXXAAA    AAAAAAAA     A")
                    .aisle("                     F D F                     ", "                       D                       ", "                       D                       ", "                       D                       ", "                       D                       ", "                       D                       ", "                    F  D  F                    ", "                       D                       ", "                  D    D    D                  ", "                  D    D    D                  ", "                  D    D    D                  ", "                  D    D    D                  ", "                  D    D    D                  ", "                  D    D    D                  ", "                  D    D    D                  ", "                 DD    D    DD                 ", "                 D     D     D                 ", "                 D     D     D                 ", "                 D   F D F   D                 ", "                 D     C     D                 ", "                 D     C     D                 ", "                 D     C     D                 ", "                 D     C     D                 ", "                DD     C     DD                ", "                D      C      D                ", "                D      C      D                ", "                D      C      D                ", "               DD      C      DD               ", "               D     FDCDF     D               ", "               D      DCD      D               ", "              DD      DCD      DD              ", "              D       DCD       D              ", "              D       DCD       D              ", "             DD      DDCDD      DD             ", "             D       D C D       D             ", "             D       D C D       D             ", "            DD       D C D       DD            ", "            D        D C D        D            ", " VV        DD VV     XDCDX     VV DD        VV ", " VI       DD  VI     XDCDX     IV  DD       IV ", " VV    DDDD   VV     XDCDX     VV   DDDD    VV ", "FVVFFFFFFD    VVFFFFFDDDDDFFFFFVV    DFFFFFFVVF", "AVVAAAAAAAAAAAVV  AAAXXXXXAAA  VVAAAAAAAAAAAVVA")
                    .aisle("                      FFF                      ", "                       E                       ", "                       E                       ", "                       E                       ", "                       E                       ", "                       E                       ", "                     F   F                     ", "                    E     E                    ", "                    E     E                    ", "                    E     E                    ", "                    E     E                    ", "                    E     E                    ", "                    E     E                    ", "                    E     E                    ", "                    E     E                    ", "                    E     E                    ", "                                               ", "                                               ", "                      FFF                      ", "                                               ", "                                               ", "                  H         H                  ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      FFF                      ", "                                               ", "                                               ", "                                               ", "                                               ", "             H                   H             ", "                                               ", "                                               ", "                                               ", "                                               ", "                      XXX                      ", "                      XXX                      ", "        D             XXX             D        ", "FFFFFFFFFF        FFFFFFFFFFF        FFFFFFFFFF", "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      FFF                      ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                   E       E                   ", "                   E       E                   ", "                   E       E                   ", "                   E       E                   ", "                   E       E                   ", "                   E       E                   ", "                   E       E                   ", "                  HE       EH                  ", "                   E       E                   ", "                   E       E                   ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "              H                 H              ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "        D                             D        ", " FFFFFFFFF         FFFFFFFFF         FFFFFFFFF ", " AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      E E                      ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                   HH     HH                   ", "                  E         E                  ", "                  E         E                  ", "                  E         E                  ", "                  E         E                  ", "                  E         E                  ", "                  E         E                  ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "              H                 H              ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "        D                             D        ", "    FFFFFF          FFFFFFF          FFFFFF    ", " AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      E E                      ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                                               ", "                                               ", "                 E           E                 ", "                 E           E                 ", "                 E           E                 ", "                 E           E                 ", "                 E           E                 ", "                                               ", "                                               ", "               H               H               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "         D                           D         ", "        FFF          F F F          FFF        ", " AAAAAAAAAAAAAAAAAAAA     AAAAAAAAAAAAAAAAAAAA ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      E E                      ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                E             E                ", "                E             E                ", "                E             E                ", "                E             E                ", "                E             E                ", "               HE             EH               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "         D                           D         ", "        FFF          F F F          FFF        ", "  AA  AAAAAAAAAAAAAAA     AAAAAAAAAAAAAAA  AA  ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      E E                      ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                                               ", "               E               E               ", "               EHH           HHE               ", "               E               E               ", "               E               E               ", "               E               E               ", "               E               E               ", "               E     V V V     E               ", "               E     I I I     E               ", "               E     V V V     E               ", "         FF    E     V V V     E    FF         ", "  AA     AAAAAAAAAAAAV V VAAAAAAAAAAAA     AA  ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      E E                      ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                  HH DE ED HH                  ", "                                               ", "                                               ", "                                               ", "                                               ", "                     V V V                     ", "                     V V V                     ", "                     V V V                     ", "                     V V V                     ", "  AA     AAAAAAAAAAAAV V VAAAAAAAAAAAA     AA  ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      E E                      ", "                    HDE EDH                    ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "   AA     AAAAAAAAAAAAAAAAAAAAAAAAAAA     AA   ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      E E                      ", "                     DE ED                     ", "                     DE ED                     ", "                     DE ED                     ", "                                               ", "                                               ", "                                               ", "   AA      AAAAAAAAAAAAAAAAAAAAAAAAA      AA   ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      E E                      ", "                     DE ED                     ", "                     DE ED                     ", "                                               ", "                                               ", "    AA      AAAAAAAAAAAAAAAAAAAAAAA      AA    ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      E E                      ", "                     DE ED                     ", "                     D   D                     ", "               FFF           FFF               ", "    AA       AAAAAAAAAAAAAAAAAAAAA       AA    ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                      E E                      ", "                DD   DE ED   DD                ", "               FFFFFFD   DFFFFFF               ", "     AA       AAAAAAAAAAAAAAAAAAA       AA     ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                  DDDDE EDDDD                  ", "                FFFFFFF FFFFFFF                ", "     AAA        AAAAAAAAAAAAAAA        AAA     ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                     D   D                     ", "                  FFFFF FFFFF                  ", "      AAA       AAAAAAAAAAAAAAA       AAA      ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                  FFFFFFFFFFF                  ", "       AAA      AAAAAAAAAAAAAAA      AAA       ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                  FFFF F FFFF                  ", "        AAAA     AAAAA   AAAAA     AAAA        ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                  FFFF F FFFF                  ", "          AAAA   AAAAA   AAAAA   AAAA          ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                   FFF F FFF                   ", "            AAAAAAAAAA   AAAAAAAAAA            ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                     V V V                     ", "                     I I I                     ", "                     V V V                     ", "                   FFV V VFF                   ", "              AAAAAAAV V VAAAAAAA              ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                     V V V                     ", "                     V V V                     ", "                     V V V                     ", "                   FFV V VFF                   ", "                 AAAAV V VAAAA                 ")
                    .aisle("                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                                               ", "                    FFFFFFF                    ", "                    AAAAAAA                    ")
                    .where(' ', any())
                    .where('-', air())
                    .where('~', selfPredicate())
                    .where('D', states(GTQTSMetaBlocks.spaceElevatorCasing.getState(GTQTSpaceElevatorCasing.ElevatorCasingType.BASIC_CASING)))
                    .where('F', states(GTQTSMetaBlocks.spaceElevatorCasing.getState(GTQTSpaceElevatorCasing.ElevatorCasingType.INTERNAL_STRUCTURE)))
                    .where('E', states(GTQTSMetaBlocks.spaceElevatorCasing.getState(GTQTSpaceElevatorCasing.ElevatorCasingType.SUPPORT_STRUCTURE)))
                    .where('A', states(GTQTSMetaBlocks.spaceElevatorCasing.getState(GTQTSpaceElevatorCasing.ElevatorCasingType.FLOOR)))
                    .where('B', states(GTQTSMetaBlocks.spaceElevatorCasing.getState(GTQTSpaceElevatorCasing.ElevatorCasingType.CABLE_CASING)))
                    .where('H', frames(Naquadah))
                    .where('X', states(GTQTSMetaBlocks.spaceElevatorCasing.getState(GTQTSpaceElevatorCasing.ElevatorCasingType.BASIC_CASING))
                            .or(abilities(MultiblockAbility.INPUT_ENERGY, MultiblockAbility.INPUT_LASER).setExactLimit(1))
                            .or(abilities(MultiblockAbility.COMPUTATION_DATA_RECEPTION).setExactLimit(1)))
                    .where('C', TiredTraceabilityPredicate.CP_SE_CASING.get())
                    .where('I', modulePredicate())
                    .where('V', states(GTQTSMetaBlocks.spaceElevatorCasing.getState(GTQTSpaceElevatorCasing.ElevatorCasingType.BASIC_CASING)).or(abilities(MultiblockAbility.IMPORT_ITEMS, MultiblockAbility.IMPORT_FLUIDS, MultiblockAbility.EXPORT_FLUIDS, MultiblockAbility.EXPORT_ITEMS).setPreviewCount(0)))
                    .build();
        }
    }

    @Override
    public boolean hasMaintenanceMechanics() {
        return false;
    }

    @Override
    public ICubeRenderer getBaseTexture(IMultiblockPart iMultiblockPart) {
        return GTQTSTextures.ELEVATOR_CASING;
    }

    @SideOnly(Side.CLIENT)

    @Override
    protected ICubeRenderer getFrontOverlay() {
        return Textures.DATA_BANK_OVERLAY;
    }

    @Override
    protected void formStructure(PatternMatchContext context) {
        super.formStructure(context);
        initializeAbilities();
        Object motorTier = context.get("SETieredStats");
        this.motorTier = GTQTSUtil.getOrDefault(() -> motorTier instanceof WrappedIntTired,
                () -> ((WrappedIntTired) motorTier).getIntTier(),
                0);

    }

    @Override
    public void checkStructurePattern() {
        if (this.getOffsetTimer() % 100 == 0 || this.isFirstTick()) {
            if (!this.isStructureFormed()) {
                reinitializeStructurePattern();
            }
            super.checkStructurePattern();
        }
    }

    @Override
    public void invalidateStructure() {
        super.invalidateStructure();
        resetTileAbilities();
        this.spaceElevatorReceivers.forEach(ISpaceElevatorReceiver::sentWorkingDisabled);
    }

    protected void initializeAbilities() {
        List<IEnergyContainer> powerInput = new ArrayList<>(getAbilities(MultiblockAbility.INPUT_ENERGY));
        powerInput.addAll(getAbilities(MultiblockAbility.INPUT_LASER));
        this.energyContainer = new EnergyContainerList(powerInput);
        List<IOpticalComputationHatch> providers = getAbilities(MultiblockAbility.COMPUTATION_DATA_RECEPTION);
        if (providers != null && providers.size() >= 1) {
            this.computationProvider = providers.get(0);
        }
    }


    private void resetTileAbilities() {
        this.energyContainer = new EnergyContainerList(new ArrayList<>());
    }

    protected TraceabilityPredicate modulePredicate() {
        return new TraceabilityPredicate(blockWorldState -> {
            IBlockState blockState = blockWorldState.getBlockState();
            Block block = blockState.getBlock();
            if (block instanceof GTQTSpaceElevatorCasing) {
                GTQTSpaceElevatorCasing.ElevatorCasingType casingType = ((GTQTSpaceElevatorCasing) blockState.getBlock()).getState(blockState);
                if (casingType == GTQTSpaceElevatorCasing.ElevatorCasingType.BASIC_CASING) return true;
            }

            TileEntity tileEntity = blockWorldState.getTileEntity();
            if (!(tileEntity instanceof IGregTechTileEntity)) return false;

            MetaTileEntity metaTileEntity = ((IGregTechTileEntity) tileEntity).getMetaTileEntity();

            if (metaTileEntity instanceof ISpaceElevatorProvider)
                return false;

            if (!(metaTileEntity instanceof ISpaceElevatorReceiver spaceElevatorReceiver)) return false;

            if (spaceElevatorReceiver.getSpaceElevator() != this) {
                spaceElevatorReceiver.setSpaceElevator(this);
                this.spaceElevatorReceivers.add(spaceElevatorReceiver);
            }
            return true;
        });
    }

    @Override
    protected ModularUI createUI(EntityPlayer entityPlayer) {
        return createUITemplate(entityPlayer).build(getHolder(), entityPlayer);
    }

    protected ModularUI.Builder createUITemplate(EntityPlayer entityPlayer) {
        ModularUI.Builder builder = ModularUI.builder(GuiTextures.BACKGROUND, 198, 238);

        // Display
        builder.image(4, 4, 190, 139, GuiTextures.DISPLAY);


        builder.label(9, 9, getMetaFullName(), 0xFFFFFF);

        builder.widget(new AdvancedTextWidget(9, 20, this::addDisplayText, 0xFFFFFF)
                .setMaxWidthLimit(220)
                .setClickHandler(this::handleDisplayClick));


        builder.widget(new ClickButtonWidget(173, 155, 18, 18, "", data -> transport(entityPlayer))
                .setButtonTexture(GTQTSTextures.BUTTON_DISABLE_STATIC)
                .setTooltipText("空间站折跃"));

        // Extend Button
        builder.widget(new ImageCycleButtonWidget(173, 213, 18, 18, GTQTSTextures.BUTTON_ELEVATOR_EXTENSION,
                this::isExtended, this::setExtended).setTooltipHoverString("gtqtspace.gui.multiblock.space_elevator_extended"));
        builder.widget(new ImageWidget(173, 201, 18, 6, GuiTextures.BUTTON_POWER_DETAIL));

        // Voiding Mode Button
        builder.widget(new ClickButtonWidget(173, 173, 18, 18, "", data -> enableAllModules())
                .setButtonTexture(GTQTSTextures.BUTTON_ENABLE_STATIC)
                .setTooltipText("gtqtspace.gui.multiblock.space_elevator.enable_all_modules"));

        builder.widget(new ClickButtonWidget(173, 191, 18, 18, "", data -> disableAllModules())
                .setButtonTexture(GTQTSTextures.BUTTON_DISABLE_STATIC)
                .setTooltipText("gtqtspace.gui.multiblock.space_elevator.disable_all_modules"));


        builder.bindPlayerInventory(entityPlayer.inventory, 155);
        return builder;
    }

    private void transport(EntityPlayer entityPlayer) {

        FMLCommonHandler.instance().getMinecraftServerInstance().getPlayerList().transferPlayerToDimension((EntityPlayerMP) entityPlayer, 50, new WorldTeleporter(entityPlayer.getServer().getWorld(50), getPos()));
    }

    @Override
    protected void addDisplayText(List<ITextComponent> textList) {
        MultiblockDisplayText.builder(textList, this.isStructureFormed())
                .addCustom(tl -> {
                    if (this.isStructureFormed()) {
                        tl.add(TextComponentUtil.translationWithColor(TextFormatting.BLUE, "gtqtspace.machine.space_elevator.motor_tier", this.motorTier));
                        tl.add(TextComponentUtil.translationWithColor(TextFormatting.YELLOW, "gtqtspace.machine.space_elevator.max_modules", getMaxModules()));

                        if (this.spaceElevatorReceivers.isEmpty()) {
                            tl.add(TextComponentUtil.translationWithColor(TextFormatting.RED, "gtqtspace.machine.space_elevator.modules.none"));
                        } else {
                            tl.add(TextComponentUtil.translationWithColor(getModuleCount() < getMaxModules() ? TextFormatting.AQUA : TextFormatting.YELLOW, "gtqtspace.machine.space_elevator.total_modules", getModuleCount()));

                            tl.add(TextComponentUtil.translationWithColor(TextFormatting.GREEN, "gtqtspace.machine.space_elevator.modules"));

                            List<String> moduleNames = new ArrayList<>();
                            List<String> uniqueNames = new ArrayList<>();
                            this.spaceElevatorReceivers.forEach(s -> {
                                moduleNames.add(s.getNameForDisplayCount());
                                if (!uniqueNames.contains(moduleNames.get(moduleNames.indexOf(s.getNameForDisplayCount())))) {
                                    uniqueNames.add(s.getNameForDisplayCount());
                                }
                            });
                            uniqueNames.forEach(s -> tl.add(TextComponentUtil.translationWithColor(TextFormatting.WHITE, s, Collections.frequency(moduleNames, s))));
                        }
                    }
                });
    }

    private boolean isExtended() {
        return this.isExtended;
    }

    private void setExtended(boolean bool) {
        this.isExtended = bool;
        this.spaceElevatorReceivers.forEach(s -> s.setSpaceElevator(null));
        reinitializeStructurePattern();
    }

    @Override
    public NBTTagCompound writeToNBT(NBTTagCompound data) {
        data.setBoolean("extended", this.isExtended);
        return super.writeToNBT(data);
    }

    @Override
    public void readFromNBT(NBTTagCompound data) {
        super.readFromNBT(data);
        this.isExtended = data.getBoolean("extended");
    }

    @Override
    public void writeInitialSyncData(PacketBuffer buf) {
        super.writeInitialSyncData(buf);
        buf.writeBoolean(this.isExtended);
    }

    @Override
    public void receiveInitialSyncData(PacketBuffer buf) {
        super.receiveInitialSyncData(buf);
        this.isExtended = buf.readBoolean();
    }

    @Override
    public int getMotorTier() {
        return this.motorTier;
    }

    @Override
    public IEnergyContainer getEnergyContainerForModules() {
        return this.energyContainer;
    }

    private int getMaxModules() {
        if (this.motorTier == 1)
            return 6;
        if (this.motorTier == 2)
            return 12;
        if (this.motorTier == 3 && this.isExtended)
            return 15;
        if (this.motorTier == 4 && this.isExtended)
            return 18;
        if (this.motorTier == 5 && this.isExtended)
            return 24;

        return 12;
    }

    private boolean checkModules() {
        return getModuleCount() <= getMaxModules();
    }

    private int getModuleCount() {
        return this.spaceElevatorReceivers.size();
    }

    private void disableAllModules() {
        this.spaceElevatorReceivers.forEach(ISpaceElevatorReceiver::sentWorkingDisabled);
    }

    private void enableAllModules() {
        this.spaceElevatorReceivers.forEach(ISpaceElevatorReceiver::sentWorkingEnabled);
    }

    @Override
    public IOpticalComputationProvider getComputationProvider() {
        return this.computationProvider;
    }

    @Override
    public void addInformation(ItemStack stack, World world, @Nonnull List<String> tooltip, boolean advanced) {
        super.addInformation(stack, world, tooltip, advanced);
        tooltip.add(I18n.format("需要所有拓展槽都安装模块控制器后才成型，插槽可使用 线缆锚定基材 代替空模块"));
        tooltip.add(I18n.format("拓展模式：请在UI内打开拓展模式，shift右键控制器即可预览"));
        tooltip.add(I18n.format("跃迁模式：可传送至空间站"));
        tooltip.add(I18n.format("请使用IV及其以上的的能源仓！"));
    }

    @Override
    @SideOnly(Side.CLIENT)
    public void renderMetaTileEntity(double x, double y, double z, float partialTicks) {
        IFastRenderMetaTileEntity.super.renderMetaTileEntity(x, y, z, partialTicks);
        //if (isStructureFormed() && GTQTCoreConfig.OBJRenderSwitch.EnableObj && GTQTCoreConfig.OBJRenderSwitch.EnableObjPrimitiveTreeFarmer) {
        if (true) {
            final int xDir = this.getFrontFacing().getOpposite().getXOffset();
            final int zDir = this.getFrontFacing().getOpposite().getZOffset();
            //机器开启才会进行渲染
            //这是一些opengl的操作,GlStateManager是mc自身封装的一部分方法  前四条详情请看 https://turou.fun/minecraft/legacy-render-tutor/
            //opengl方法一般需要成对出现，实际上他是一个状态机，改装状态后要还原  一般情况按照我这些去写就OK
            GlStateManager.pushAttrib(); //保存变换前的位置和角度
            GlStateManager.pushMatrix();
            GlStateManager.disableLighting();
            GlStateManager.disableCull();
            FMLClientHandler.instance().getClient().getTextureManager().bindTexture(ObjModels.climber_pic); //自带的材质绑定 需要传递一个ResourceLocation
            GlStateManager.translate(x, y, z);//translate是移动方法 这个移动到xyz是默认的 不要动
            GlStateManager.translate(xDir * 3 + 0.5, 150, zDir * 3 + 0.5);//translate是移动方法 这个移动到xyz是默认的 不要动


            float angle = (System.currentTimeMillis() % 36000) / 100.0f; //我写的随时间变化旋转的角度
            //GlStateManager.rotate(90, 0F, 1F, 0F);//rotate是旋转模型的方法  DNA的初始位置不太对 我旋转了一下   四个参数为：旋转角度，xyz轴，可以控制模型围绕哪个轴旋转
            GlStateManager.rotate(angle, 0F, 1F, 0F);//我让dna围绕z轴旋转，角度是实时变化的


            GlStateManager.scale(6, 6, 6);
            // ObjModels.Tree_Model.renderAllWithMtl(); //这个是模型加载器的渲染方法  这是带MTL的加载方式
            ObjModels.climber.renderAll(); //这个是模型加载器的渲染方法  这是不带MTL的加载方式
            GlStateManager.popMatrix();//读取变换前的位置和角度(恢复原状) 下面都是还原状态机的语句
            GlStateManager.enableLighting();
            GlStateManager.popAttrib();
            GlStateManager.enableCull();
        }

    }

    //渲染模型的位置

    @Override
    public AxisAlignedBB getRenderBoundingBox() {
        //这个影响模型的可视范围，正常方块都是 1 1 1，长宽高各为1，当这个方块离线玩家视线后，obj模型渲染会停止，所以可以适当放大这个大小能让模型有更多角度的可视
        return new AxisAlignedBB(getPos().add(-10, -10, -10), getPos().add(10, 10, 10));
    }

    @Override
    public void renderMetaTileEntity(CCRenderState renderState, Matrix4 translation, IVertexOperation[] pipeline) {
        super.renderMetaTileEntity(renderState, translation, pipeline);
        this.getFrontOverlay().renderOrientedState(renderState, translation, pipeline, getFrontFacing(), true, true);
    }
    @Override
    public boolean isGlobalRenderer()
    {
        return true;
    }
}